\NextFile{BuildingScenarios.html}
\chapter{Building new scenarios}

Starting  a new scenario (our term for the application of MATSim to a  region/area) can appear quite cumbersome at the first glace, as a lot of  data preparation may be required.In any case required for a new  scenario are:
\begin{itemize}
	\item description of the \textbf{network}
	\item description of the travel \textbf{demand} (synthetic \textbf{population})
\end{itemize}

Given these two data items, you can already start building your own scenario.The "\href{http://www.matsim.org/docs/tutorials/learningIn3days}{Learning MATSim in 3 days}"-Tutorial gives you an introduction on how to build your own scenario.

\subsubsection{Import from VISUM}

See \href{http://matsim.org/javadoc/org/matsim/visum/package-summary.html}{here for javadoc}, and \href{http://matsim.org/xref/org/matsim/visum/package-summary.html}{here for code}.

\subsubsection{Programming}

In many cases, using pre-configured software is not possible because  there are just too many possibilities of how input could look like.  Although matsim is not there yet, these should be api-only use cases,  i.e. they should only use the "stable" api. Therefore, the  following are under the api-users section of the documentation:
\begin{itemize}
	\item Additional information about network generation is \href{http://matsim.org/node/588}{here}.
	\item additional information about initial demand generation is \href{http://matsim.org/node/340}{here}.
\end{itemize}

\subsubsection{Information concerning specific scenarios}

The following sections contains various information for building a scenario that presumably goes beyond what is in the tutorial.

\section{Coordinate Systems in MATSim}

For  some operations, MATSim must know about the coordinate system your data  is in. For example, If you want to generate kml-Output for  Counts-Validation, MATSim has to convert the coordinates in your network  to WGS84, the coordinate system used by Google Earth.


\subsubsection{Specifying the Coordinate System used}

You can specify the coordinate system in the config-file:
\begin{lstlisting}{language=XML}
<module name="global">
  <param name="coordinateSystem" value="CH1903LV1903" />
</module>
\end{lstlisting}

The value specified for the coordinateSystem parameter can be:
\begin{itemize}
	\item The short-name of a coordinate system known to MATSim. We define  names for coordinate systems we use regularly in our work. These names  are currently defined in \href{http://matsim.svn.sourceforge.net/viewvc/matsim/matsim/trunk/src/main/java/org/matsim/core/utils/geometry/transformations/TransformationFactory.java?view=markup}{TransformationFactory}. The short-name 
\texttt{Atlantis}  stands for an artificial coordinate system which maps our examples  without relation to the real world somewhere in to the Atlantic ocean.
	\item Well-Known-Text (\href{http://www.geoapi.org/snapshot/javadoc/org/opengis/referencing/doc-files/WKT.html}{WKT})  description of a coordinate system as they are supported by Geotools.  This variant is not very readable, but allows one to experiment also in  regions where MATSim does not provide a short-name for. Examples of WKT  can be found in the MATSim-class \href{http://matsim.svn.sourceforge.net/viewvc/matsim/matsim/trunk/src/main/java/org/matsim/core/utils/geometry/geotools/MGC.java?view=markup}{MGC}(in the 
\texttt{transformations} map).
\end{itemize}

\subsubsection{Notes about Coordinate Systems}

As the distance calculation in WGS84-coordinates (or any spherical coordinates) is rather complex (a simple \href{http://en.wikipedia.org/wiki/Pythagorean_theorem}{Pythagoras} is not enough), we advise people to use a \href{http://en.wikipedia.org/wiki/Coordinate_system}{Cartesian coordinate systems},  preferable where one unit corresponds to one meter. Using such a  coordinate system is a pre-requisit if one wants to use the optimized  A*Landmarks-Router in MATSim.

\section{Using MATSim for Switzerland}

\subsubsection{General remarks}

This is material that was in the tutorial "Learning MATSim in 3 days". We moved it to here, but did not check the content.

A. Horni: Shortly, there will be a working paper describing the usage of MATSim for Switzerland., 02.05.2011

\subsubsection{Some data sources}
\begin{itemize}
	\item Microcensus (BfS):\\ \href{http://www.bfs.admin.ch/bfs/portal/de/index/themen/11/07/01/02/01.html}{www.bfs.admin.ch/bfs/portal/de/index/themen/11/07/01/02/01.html}
	\item Census (BfS):\\ \href{http://www.bfs.admin.ch/bfs/portal/en/index/infothek/erhebungen__quellen/blank/blank/vz/uebersicht.html}{www.bfs.admin.ch/bfs/portal/en/index/infothek/erhebungen\_\_quellen/blank/blank/vz/uebersicht.html}
	\item ASTRA traffic counts:\\ \href{http://www.astra.admin.ch/verkehrsdaten/00299/00303/index.html?lang=en}{www.astra.admin.ch/verkehrsdaten/00299/00303/index.html}
	\item Business census (BfS):\\ \href{http://www.bfs.admin.ch/bfs/portal/en/index/infothek/erhebungen__quellen/blank/blank/bz/01.html}{www.bfs.admin.ch/bfs/portal/en/index/infothek/erhebungen\_\_quellen/blank/blank/bz/01.html}
	\item Border crossing traffic (IVT, BfS):\\ \href{http://www.bfs.admin.ch/bfs/portal/de/index/themen/11/07/04/blank/01/01.html}{www.bfs.admin.ch/bfs/portal/de/index/themen/11/07/04/blank/01/01.html}
\end{itemize}


%%\vfill\eject
%%\section{Using MATSim from Urbansim (for the PSRC region)}

%%Deprecated (and soon to be removed). See \href{http://matsim.org/extensions/matsim4urbansim}{here} instead.



%%\sout{Check  out the opus source tree from www.urbansim.org . (The source tree  is the tree containing directories such as opus\_core or opus\_gui.)}

%%\sout{In this source tree, there should be a directory opus\_matsim .}

%%\sout{There is documentation in opus\_matsim/docs .}

